"use strict";(self["webpackChunkvue_canvas_keyframes"]=self["webpackChunkvue_canvas_keyframes"]||[]).push([[69],{5069:(e,n,r)=>{r.r(n),r.d(n,{default:()=>F});var t=r(9835);function a(e,n,r,a,i,o){const l=(0,t.up)("the-background");return(0,t.wg)(),(0,t.j4)(l)}var i=r(6970);const o=e=>((0,t.dD)("data-v-2e0f1744"),e=e(),(0,t.Cn)(),e),l=o((()=>(0,t._)("h1",{class:"b-background__title"},"Scroll down",-1))),c={class:"b-background__canvas",ref:"canvasRef"};function s(e,n,r,a,o,s){const u=(0,t.Q2)("scroll");return(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",{class:"b-background",style:(0,i.j5)({height:`${e.keyframeCore.wrapperHeight.value}px`})},[l,(0,t._)("canvas",c,null,512)],4)),[[u,e.keyframeCore.setCurrentFrame]])}var u=r(499),d=r(9302),v=function(e,n,r,t){function a(e){return e instanceof r?e:new r((function(n){n(e)}))}return new(r||(r=Promise))((function(r,i){function o(e){try{c(t.next(e))}catch(n){i(n)}}function l(e){try{c(t["throw"](e))}catch(n){i(n)}}function c(e){e.done?r(e.value):a(e.value).then(o,l)}c((t=t.apply(e,n||[])).next())}))};const h=(e,n)=>v(void 0,void 0,void 0,(function*(){const r=e=>e<10?`00${e}.jpg`:e<100?`0${e}.jpg`:`${e}.jpg`,t=[];for(let i=1;i<=n;i+=1){const n=r(i),a=fetch(`${e}/${n}`);t.push(a)}const a=(yield Promise.all(t)).map((e=>e.blob()));return(yield Promise.all(a)).map((e=>URL.createObjectURL(e)))})),w=()=>{const e=(0,u.iH)([]),n={perFrames:10,fps:15,interval:0,scrollLength:100},r=(0,u.iH)(0),a=(0,u.iH)(0),i=e=>{const t=Math.ceil(e/n.scrollLength),a=t*n.perFrames,i=()=>{a>r.value&&(r.value+=1),a<r.value&&(r.value-=1),a===r.value&&clearInterval(n.interval)};a!==r.value&&(i(),clearInterval(n.interval),n.interval=window.setInterval(i,n.fps))};return(0,t.bv)((()=>v(void 0,void 0,void 0,(function*(){e.value=yield h("keyframes",240),a.value=window.innerHeight+e.value.length/n.perFrames*n.scrollLength})))),{currentFrame:r,setCurrentFrame:i,keyframes:e,wrapperHeight:a}},g=()=>{let e=!0,n=null,r=null,a=[];const i=(e,n)=>{const t=e.height/e.width,a=window.innerHeight/window.innerWidth;if(t<a&&"contain"===n||t>a&&"cover"===n){const n=window.innerWidth*t;null===r||void 0===r||r.drawImage(e,0,(window.innerHeight-n)/2,window.innerWidth,n)}if(t>a&&"contain"===n||t<a&&"cover"===n){const n=window.innerWidth*a/t;null===r||void 0===r||r.drawImage(e,(window.innerWidth-n)/2,0,n,window.innerHeight)}},o=(e,t)=>{r=e.getContext("2d"),n=e,n.width=window.innerWidth,n.height=window.innerHeight,a=t.map((e=>{const n=new Image;return n.src=e,n}))},l=e=>{var t,o;const l=null!==(t=null===n||void 0===n?void 0:n.width)&&void 0!==t?t:0,c=null!==(o=null===n||void 0===n?void 0:n.height)&&void 0!==o?o:0;null===r||void 0===r||r.clearRect(0,0,l,c),i(a[e.value],"cover")},c=n=>{window.requestAnimationFrame((()=>{n.value<a.length&&l(n),e&&c(n)}))},s=(e,n,r)=>{o(e,n),c(r)};return(0,t.bv)((()=>{e=!0})),(0,t.Ah)((()=>{e=!1})),{ctx:r,canvas:n,images:a,cover:i,init:o,render:l,run:c,start:s}},f=(0,t.aZ)({name:"TheBackground",setup(){const e=(0,d.Z)(),n=(0,u.iH)(),r=n=>n?e.loading.show():e.loading.hide(),a=w(),i=g();return(0,t.YP)(a.keyframes,(()=>{const e=n.value,{keyframes:t,currentFrame:o}=a;t.value.length&&(i.start(e,t.value,o),r(!1))})),(0,t.bv)((()=>{r(!0)})),{keyframeCore:a,canvasRef:n}}});var m=r(1639),p=r(4877),k=r(9984),y=r.n(k);const b=(0,m.Z)(f,[["render",s],["__scopeId","data-v-2e0f1744"]]),_=b;y()(f,"directives",{Scroll:p.Z});const H=(0,t.aZ)({name:"IndexPage",components:{TheBackground:_},setup(){return{}}}),C=(0,m.Z)(H,[["render",a]]),F=C}}]);